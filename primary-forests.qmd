---
title: Explore
author: Otho Mantegazza
date: today
editor_options: 
  chunk_output_type: console
---

```{r packages}
library(tidyverse)
library(sf)
library(leaflet)
library(janitor)
library(lwgeom)
library(units)
library(spData)
```

```{r data}
sf_use_s2(FALSE)
db <- 'data/PrimaryForest_EU_OA_WGS84_polygons/'
forests <- read_sf(db) %>% clean_names()
forest_data <- forests %>% as_tibble() %>% select(-geometry)
```

```{r}

```


# Definition

Primary Forest:

> "naturally regenerated forest of native tree species, where there are no clearly visible indications of human activities and the ecological processes are not significantly disturbed."

# Source

|          |                                                             |
|----------|-------------------------------------------------------------|
| Article  | [https://www.nature.com/articles/s41597-021-00988-7](https://www.nature.com/articles/s41597-021-00988-7)   |
| Data     | [https://doi.org/10.6084/m9.figshare.13194095.v1](https://doi.org/10.6084/m9.figshare.13194095.v1)             |
| Original | [https://www.nature.com/articles/s41597-021-00988-7/tables/4](https://www.nature.com/articles/s41597-021-00988-7/tables/4) |

# Areas

The database records `r nrow(forests)` patches of primary forest in the european continent.

They are divided geographically in:

```{r}
forests$area_m2 <- forests %>% st_area()
```

```{r}
forest_data <- forests %>% as_tibble() %>% select(-geometry)
```


```{r}
forests %>% 
  ggplot() +
  aes(y = area_m2,
      x = area_ha) +
  geom_point()
```

## Join with countries

```{r}
forests <- st_join(forests, world["name_long"]) %>% rename(country = name_long)
```

```{r}
ukraine <- 
  forests %>% 
  filter(co)
```


## Location

```{r}
forest_data %>% 
  group_by(location) %>% 
  summarise(area_m2 = area_m2 %>% sum(na.rm = T)) %>% 
  arrange(desc(area_m2))
```

## Species

```{r}
forest_data %>% 
  group_by(dominant_1) %>% 
  summarise(area_m2 = area_m2 %>% sum(na.rm = T)) %>% 
  arrange(desc(area_m2))


forest_data %>% 
  group_by(dominant_t, dominant_1, dominant_2) %>% 
  summarise(area_m2 = area_m2 %>% sum(na.rm = T)) %>% 
  arrange(desc(area_m2)) %>% 
  view()

```




```{r}
leaflet(forests) %>% addTiles() %>% addPolygons()
```

```{r}
# forest_lite <- forests %>% st_union()
```


